<HTML>
<head>
<title>DFO/ITQ Survey Numbers and Weights</title>
<script type="text/javascript" src="/r/parser.js"></script>
<script type="text/javascript" src="/r/scripts.js"></script>
<link rel="stylesheet" type="text/css" href="/r/rStyle.css" />

<script type="text/javascript">
window.onload=function() {
		for (var j=0;j<document.forms[0].elements.length;j++){
			document.forms[0].elements[j].onchange=function(){parseIt(0);}
		}
}
</script>
</head>
<body>
<h1 class="statTitle">DFO/ITQ Survey Numbers and Weights</h1>
<noscript><div class="warning"><b>Warning:</b> Enabling Javascript will give you a better experience, including access to the SQL generated by this page.</div></noscript>
<div class="warning">April 17, 2013 - These analyses have not yet been rigorously QC'd.
</div>
<legend>DFO/ITQ Survey Numbers and Weights</legend>
<form id ="0" action="/plonescript/mfnumbersandweights.R" method="post">

<!--- statserver arguments --->

<input type="hidden" name="AOC" value="mfnumbersandweights">
<input type=hidden name="Return" value=3>
<input type=hidden name="graphic" value=0>
<input type=hidden name=fileOut value=6>
<input type=hidden name=graphicFormat value="GIF">
<input type="hidden" name="SqlInDsn" value="bank2">

<!--- make query arguments --->

<input type="hidden" name="ProcessSql" value=true>
<input type="hidden" name="QueryArgs" value="1100">
<input type="hidden" name="TitleArgs" value="1101">
<input type="hidden" name="NumDataArgs" value="2">
<input type="hidden" name="DataName1" value="Title">
<input type="hidden" name="Data1" value="DFO/ITQ Survey Numbers and Weights">
<input type="hidden" name="DataName2" value="Overlay Plots">

<input type="hidden" name="sselect" value="
SELECT i.year, 0 dummy, SUM(i.sets) sets, 
 ROUND(SUM(NVL(c.total_num,0))/SUM(i.sets),1) average_number, 
 ROUND(SUM(NVL(c.total_wgt,0))/SUM(i.sets),1) average_weight
 FROM 
 (SELECT year, COUNT(1) sets
 FROM mflib.isinf_7051 i
 WHERE haulccd_id IN (1,2,3)
 AND stratum_id IN (SELECT DISTINCT strat FROM groundfish.gsmgt WHERE unit IN (:bind__Strata))
 GROUP BY year) i, 
 (SELECT c.year, 
	 SUM(c.est_combined_wt :bind__DistTowed_noquote) total_wgt, 
 SUM(c.totno :bind__DistTowed_noquote) total_num 
 FROM mflib.iscat_7051 c, mflib.isinf_7051_calc d
 WHERE :bind__LenFreq_noquote 
 c.fishset_id=d.fishset_id AND c.haulccd_id IN (1,2,3) 
 AND c.speccd_id IN (SELECT DISTINCT research FROM species_codes WHERE common=:bind__Species)
 AND c.stratum_id IN (SELECT DISTINCT strat FROM groundfish.gsmgt WHERE unit IN (:bind__Strata))
 GROUP BY c.year) c
 WHERE i.year=c.year(+)
 AND i.year >= 1996
 GROUP BY i.year	
 ORDER by 1 
 " />
 
<fieldset><legend>Strata</legend> 
<select name=bind__Strata size="5" multiple>
 <option value="ALL" selected>ALL</option>
 <option value="4Xmnop">4Xmnop</option> 
 <option value="4Xqrs">4Xqrs</option>
 <option value="4X ">4X</option> 
 <option value="460 ">460</option> 
 <option value="470 ">470</option> 
 <option value="471 ">471</option> 
 <option value="472 ">472</option> 
 <option value="473 ">473</option> 
 <option value="474 ">474</option> 
 <option value="475 ">475</option> 
 <option value="476 ">476</option> 
 <option value="477 ">477</option> 
 <option value="478 ">478</option> 
 <option value="480 ">480</option> 
 <option value="481 ">481</option> 
 <option value="482 ">482</option> 
 <option value="483 ">483</option> 
 <option value="484 ">484</option> 
 <option value="485 ">485</option> 
 <option value="490 ">490</option> 
 <option value="491 ">491</option> 
 <option value="492 ">492</option> 
 <option value="493 ">493</option> 
 <option value="494">494</option>
 <option value="495 ">495</option> 
 <option value="499 ">499</option> 
</select>
</fieldset>

<fieldset><legend>Species</legend> 
<select name=bind__Species size="5">
<option value="ALEWIFE">ALEWIFE</option>
<option value="AMERICAN PLAICE">AMERICAN PLAICE</option>
<option value="ARGENTINE(ATLANTIC)">ARGENTINE(ATLANTIC)</option>
<option value="BARNDOOR SKATE">BARNDOOR SKATE</option>
<option value="BLUEBACK HERRING">BLUEBACK HERRING</option>
<option value="BUTTERFISH">BUTTERFISH</option>
<option value="COD(ATLANTIC)">COD(ATLANTIC)</option>
<option value="CUSK">CUSK</option>
<option value="EELPOUTS(NS)">EELPOUTS(NS)</option>
<option value="FOURSPOT FLOUNDER">FOURSPOT FLOUNDER</option>
<option value="HADDOCK" selected>HADDOCK</option>
<option value="HAKE (NS)">HAKE (NS)</option>
<option value="HALIBUT(ATLANTIC)">HALIBUT(ATLANTIC)</option>
<option value="HERRING(ATLANTIC)">HERRING(ATLANTIC)</option>
<option value="LONGHORN SCULPIN">LONGHORN SCULPIN</option>
<option value="LUMPFISH">LUMPFISH</option>
<option value="MACKEREL(ATLANTIC)">MACKEREL(ATLANTIC)</option>
<option value="MONKFISH,GOOSEFISH,ANGLER">MONKFISH,GOOSEFISH,ANGLER</option>
<option value="OCEAN POUT(COMMON)">OCEAN POUT(COMMON)</option>
<option value="POLLOCK">POLLOCK</option>
<option value="REDFISH UNSEPARATED">REDFISH UNSEPARATED</option>
<option value="ROCK GUNNEL(EEL)">ROCK GUNNEL(EEL)</option>
<option value="ROSEFISH(BLACK BELLY)">ROSEFISH(BLACK BELLY)</option>
<option value="SCULPINS">SCULPINS</option>
<option value="SEA RAVEN">SEA RAVEN</option>
<option value="SHAD AMERICAN">SHAD AMERICAN</option>
<option value="SILVER HAKE">SILVER HAKE</option>
<option value="SKATES (NS)">SKATES (NS)</option>
<option value="SMOOTH SKATE">SMOOTH SKATE</option>
<option value="SPINY DOGFISH">SPINY DOGFISH</option>
<option value="SQUIRREL OR RED HAKE">SQUIRREL OR RED HAKE</option>
<option value="STRIPED ATLANTIC WOLFFISH">STRIPED ATLANTIC WOLFFISH</option>
<option value="THORNY SKATE">THORNY SKATE</option>
<option value="TWOHORN SCULPIN">TWOHORN SCULPIN</option>
<option value="WHITE HAKE">WHITE HAKE</option>
<option value="WINTER FLOUNDER">WINTER FLOUNDER</option>
<option value="WINTER SKATE">WINTER SKATE</option>
<option value="WITCH FLOUNDER">WITCH FLOUNDER</option>
<option value="WOLFFISH,UNIDENT.">WOLFFISH,UNIDENT.</option>
<option value="YELLOWTAIL FLOUNDER">YELLOWTAIL FLOUNDER</option>
</select>
</fieldset>

<fieldset><legend>Tweaks</legend>
Select only catches with length frequency samples ?
<input type="radio" name="bind__LenFreq_noquote" value="catch_id IN (SELECT DISTINCT catch_id FROM islf_7051) AND " >Yes</input>
<input type="radio" name="bind__LenFreq_noquote" value=" " checked > No</input>
<br>
Standardize Catch by Calculated Distance Towed?
<input type="radio" name="bind__DistTowed_noquote" value="*(1.0/d.distance)" checked > Yes</input>
<input type="radio" name="bind__DistTowed_noquote" value=" " > No</input>
</fieldset>

<div style="clear:both;"/>
<fieldset>
<legend>Overlay plots</legend>
(Number & Weight) 
<input type="radio", name="Data2", value="true" checked> Yes</input> 
<input type="radio", name="Data2", value="false" > No</input> 
</fieldset>
<div style="clear:both;"/>
<input type=submit value="Run Analysis" />
</form>
<div style="clear:both;"/>
<script type="text/javascript">
<!-- 
document.write('<input type="checkbox" onclick=\x22parseIt(0);toggle(\x27theSQL0\x27);\x22>Show Sql ...</input>')
//-->
</script>
<div style="clear:both;"/>
<div id="theSQL0" class="code" style="display:none" onclick="selectText('theSQL0')">Please select some options to create the SQL</div>
</fieldset>
<div style="clear:both;"/>
<div id="scriptInfo">
<p>April 17, 2013 - Analysis now uses R rather than Statserver - if you notice any problems with this page, please contact Mike McMahon</p> 
</div>
</BODY>
</HTML>